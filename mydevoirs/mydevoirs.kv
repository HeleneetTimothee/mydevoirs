#: import MATIERES mydevoirs.constants.MATIERES
#: import COLORS mydevoirs.constants.COLORS
#: import datas  mydevoirs.datas.datas
#: import MatiereOption mydevoirs.matiere_dropdown.MatiereOption
#: import MatiereDropdown mydevoirs.matiere_dropdown.MatiereDropdown
#: import gmc mydevoirs.utils.gmc


<ActionBar>:
    ActionView:
		ActionPrevious:
			with_previous: False

        ActionButton:
            text: "Semaine en cours"
		    icon: datas['icon_todo']
            on_release: app.go_todo()
        ActionButton:
		    icon: datas['icon_agenda']
            on_release: app.go_agenda()
		ActionButton:
		    icon: datas['icon_precedant'] if app.sm.current == "agenda" else ""
		    on_release: app.sm.current_screen.carousel.load_previous()
		    disabled: app.sm.current != "agenda"
		    background_disabled_normal: self.background_normal

		ActionButton:
		    icon: datas['icon_suivant'] if app.sm.current == "agenda" else ""
		    disabled: app.sm.current != "agenda"
		    background_disabled_normal: self.background_normal
		    on_release: app.sm.current_screen.carousel.load_next()

		ActionButton:
		    text: 'Param√®tres'
		    # icon: 'data/icons/chevron-right.png'
		    on_release: app.open_settings()

<BaseGrid>:
	spacing: dp(10)
	padding: dp(10)
	canvas.before:
		Color:
			rgba: COLORS["fond"]
		Rectangle:
			pos: self.pos
            size: self.size


<JourWidget>:
	orientation: 'vertical'
	canvas.before:
		Color:
			rgba: COLORS['card']
		Rectangle:
			pos: self.pos
            size: self.size
	BoxLayout:
		orientation: 'horizontal'
		size_hint_y: None
		height: dp(30)
		canvas.before:
			Color:
				rgba: COLORS['card_entete']
			Rectangle:
				pos: self.pos
	            size: self.size
	    Label:
	    	id: titre_jour
	    	text: root.nice_date
	    	font_name: datas['font_base']
	    	font_size: sp(16)
	    Label:
	    	text: root.progression
	    	font_name: datas['font_base']
	    	font_size: sp(16)
	    	size_hint_x: 0.3
	    	color: COLORS['fond'] if root.progression[0] == root.progression[2] else COLORS['progression']
	    Button:
	    	id: add_button
	    	size_hint_x: 0.2
	    	# width: self.height
	    	background_color: (0,0,0,0)
	    	# background_normal: ''
	    	on_release: root.add_item()
	    	BoxLayout:
	            pos: self.parent.pos
	            size: self.parent.size
		    	Image:
		    		source: datas['icon_new']
		    		# x: self.parent.x + self.width/2
		    		# y: self.parent.y + self.height/2
	ScrollView:
		id: scroll_items
		do_scroll_x: False
		# canvas.before:
	 #        Color:
	 #            rgb: COLORS['card']
	 #        Rectangle:
	 #        	pos: self.pos
	 #        	size: self.size


<JourItems>:
	id: jours_items
	size_hint_y: None
	spacing: dp(5)
	padding: dp(5)
	cols: 1
	# canvas.before:
	# 	Color:
	# 		rgba: COLORS['card']
	# 	Rectangle:
	# 		pos: self.pos
 #            size: self.size



<ItemWidget>:
	size_hint_y: None
	height: dp(30)
	spacing: dp(5)
	canvas:
        Color:
            rgb: rgba(root.matiere_color)
        Rectangle:
        	pos: self.pos
        	size: self.size

	Button:
		id: spinner
		text: root.matiere_nom
		on_release:
			MatiereDropdown().open(self)
		background_color: gmc(self.text)
		background_normal: ''
		color: (0,0,0,1)
		size_hint_x: 0.4
		font_size: sp(14)
		font_name: datas['font_base']


	TextInput:
		id : textinput
		text: root.content
		on_text: root.content = self.text
		halign: 'left'
    	valign: 'middle'
    	multiline: False
    	write_tab: False
    	font_name: datas['font_base']
    	font_size: sp(14)


    ToggleButton:
    	id: done
    	size_hint_x: 0.1
    	# source: datas['icon_unchecked']
		background_color: (1, 1, 1, 0)
    	background_normal: ''
	    on_release: root.done = (not root.done)
    	BoxLayout:
            pos: self.parent.x, self.parent.y +self.parent.height/2 - self.height/2
            size: self.parent.width*0.9, self.parent.height*0.9
	    	Image:
	    		source: datas['icon_checked'] if root.done else datas['icon_unchecked']


	Button:
		id: remove_item 
    	size_hint_x: 0.1
		on_release: root.remove()
		background_color: (1, 1, 1, 0)
		BoxLayout:
            pos: self.parent.x, self.parent.y +self.parent.height/2 - self.height/2
            size: self.parent.width*0.7, self.parent.height*0.7
	    	Image:
	    		source: datas['icon_remove']

<EffacerPopup>:
	title: f"Effacer  {root.item.matiere_nom}: {root.item.content} ?"
    size_hint: .5, .2
    BoxLayout:
    	orientation: 'horizontal'
        Button:
        	id: oui
        	text: "oui"
	        on_press:
	        	root.item.remove_after_confirmation()
	        	root.dismiss()
	    Button:
	    	id: non
	    	text: "non"
	    	on_press:
	    		root.dismiss()

<CarouselWidget>:

<DateLabel>:
	size_hint_y: None
	height: dp(30)
	spacing: dp(5)
	font_name: datas['font_base']
	font_size: sp(16)
	canvas.before:
        Color:
            rgb: COLORS['card_entete']
        Rectangle:
        	pos: self.pos
        	size: self.size