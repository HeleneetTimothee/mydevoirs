image:
- Visual Studio 2017
# - Visual Studio 2019

environment:
    # The package name
    PACKAGE: "mydevoirs"
    SUBLIME_TEXT_VERSION : "3"
    KIVY_GL_BACKEND: angle_sdl2

install:
    - "SET PYTHON=C:\\Python37"
    - "SET PATH=%PYTHON%;%PYTHON%\\Scripts;%PATH%"
    - python --version
    - appveyor DownloadFile "https://raw.githubusercontent.com/sdispater/poetry/master/get-poetry.py"
    - python get-poetry.py -y
    - ps: iex ((new-object net.webclient).DownloadString('https://raw.githubusercontent.com/appveyor/ci/master/scripts/enable-desktop.ps1'))
    - "SET PATH=%USERPROFILE%\\.poetry\\bin;%PATH%"
    - poetry run python -m pip install -U pip
    - poetry run python -m pip install docutils pygments pypiwin32 kivy_deps.sdl2==0.1.22 kivy_deps.glew==0.1.12 kivy_deps.gstreamer==0.1.17 kivy_deps.angle==0.1.9 pywin32-ctypes pefile 
    - poetry install


build: off

test_script:

    - poetry -V
    - poetry run pytest


after_test:
    - poetry run  pyinstaller -y --clean main_win.spec

artifacts:
    - path: dist/MyDevoirs.exe

deploy:
    provider: GitHub
    description: ""
    auth_token:
        secure: jOc864aSLCmCpG28CvNJB/0AgdcPUggAF/Cum78+Lw1sNPO/xn7LCTtLHzpDxzgBQHSGeBMh25KDn8RD24udfIVsVOe4TLKD3l23LEcG0c2WU3Pb/Ci7zu6GE3+LUOCJGHMI9uSZS232Ssh/iMYCT0kQh5h1onUN1AfjZbsNsLGaMiMK3r3lngWV+n60X56tzCLWniBoqKVeNIeDm7qTHt42f3bGQ3Y9QrNdtfL8vJuEGnyA/cSarR0HZFH1IGtK0VkjWr8jeew6sfpEEepI8TNTsKRJ71HAYcbEku7s+GrOU029qBID8vgCcCZy+H4W4KEFUnpVjraaVDFwV1l3tu/4wCtx9U8jI21V92uuMiNOjheXrDuJjXNCBLtYaQ43Q/9UwAFYCX1f3lcn0MchBkBwUFGhCpsRe5b08WnJ3J8Op6a+Cg/PL9CQJFOoTtHdlBG7afY4WrYVK5Hr8NUVoJc/YzcjOnJg5TKfxKWmYjMlYBAH3w83SsZm8YuCXfpb
    # on:
    #     branch: master
    #     APPVEYOR_REPO_TAG: true
